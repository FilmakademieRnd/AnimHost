\doxysection{onnxruntime\+\_\+training\+\_\+cxx\+\_\+api.\+h}
\hypertarget{onnxruntime__training__cxx__api_8h_source}{}\label{onnxruntime__training__cxx__api_8h_source}\index{C:/Users/m5963/Documents/GitHub/AnimHost/AnimHost/animHost\_Plugins/BasicOnnxPlugin/onnxruntime/include/onnxruntime\_training\_cxx\_api.h@{C:/Users/m5963/Documents/GitHub/AnimHost/AnimHost/animHost\_Plugins/BasicOnnxPlugin/onnxruntime/include/onnxruntime\_training\_cxx\_api.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ (c)\ Microsoft\ Corporation.\ All\ rights\ reserved.}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ Licensed\ under\ the\ MIT\ License.}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}onnxruntime\_training\_c\_api.h"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <optional>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <variant>}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{keyword}{namespace\ }Ort::detail\ \{}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#define\ ORT\_DECLARE\_TRAINING\_RELEASE(NAME)\ \(\backslash\)}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\ \ void\ OrtRelease(Ort\#\#NAME*\ ptr);}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{comment}{//\ These\ release\ methods\ must\ be\ forward\ declared\ before\ including\ onnxruntime\_cxx\_api.h}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ otherwise\ class\ Base\ won't\ be\ aware\ of\ them}}
\DoxyCodeLine{00016\ ORT\_DECLARE\_TRAINING\_RELEASE(CheckpointState);}
\DoxyCodeLine{00017\ ORT\_DECLARE\_TRAINING\_RELEASE(TrainingSession);}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \}\ \ \textcolor{comment}{//\ namespace\ Ort::detail}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}onnxruntime\_cxx\_api.h"{}}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_ort}{Ort}}\ \{}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00030\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_ort_training_api}{OrtTrainingApi}}\&\ \mbox{\hyperlink{namespace_ort_af2b7b25419c1fbfa0f18a35f7cadf5e3}{GetTrainingApi}}()\ \{\ \textcolor{keywordflow}{return}\ *\mbox{\hyperlink{namespace_ort_a296b5958479d9889218b17bdb08c1894}{GetApi}}().\mbox{\hyperlink{struct_ort_api_ac714d93e08c879793e642e7427a86546}{GetTrainingApi}}(\mbox{\hyperlink{group___global_gac583aeb4640621ceb588f6300537945d}{ORT\_API\_VERSION}});\ \}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{keyword}{namespace\ }detail\ \{}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#define\ ORT\_DEFINE\_TRAINING\_RELEASE(NAME)\ \(\backslash\)}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\ \ inline\ void\ OrtRelease(Ort\#\#NAME*\ ptr)\ \{\ GetTrainingApi().Release\#\#NAME(ptr);\ \}}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ ORT\_DEFINE\_TRAINING\_RELEASE(CheckpointState);}
\DoxyCodeLine{00038\ ORT\_DEFINE\_TRAINING\_RELEASE(TrainingSession);}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#undef\ ORT\_DECLARE\_TRAINING\_RELEASE}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#undef\ ORT\_DEFINE\_TRAINING\_RELEASE}}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \}\ \ \textcolor{comment}{//\ namespace\ detail}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \textcolor{keyword}{using\ }Property\ =\ std::variant<int64\_t,\ float,\ std::string>;}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00063\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_ort_1_1_checkpoint_state}{CheckpointState}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{struct_ort_1_1detail_1_1_base}{detail::Base}}<OrtCheckpointState>\ \{}
\DoxyCodeLine{00064\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00065\ \ \ \mbox{\hyperlink{class_ort_1_1_checkpoint_state}{CheckpointState}}(OrtCheckpointState*\ checkpoint\_state)\ \{\ p\_\ =\ checkpoint\_state;\ \}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00068\ \ \ \textcolor{comment}{//\ Construct\ the\ checkpoint\ state\ by\ loading\ the\ checkpoint\ by\ calling\ LoadCheckpoint}}
\DoxyCodeLine{00069\ \ \ \mbox{\hyperlink{class_ort_1_1_checkpoint_state}{CheckpointState}}()\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00085\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{class_ort_1_1_checkpoint_state}{CheckpointState}}\ \mbox{\hyperlink{class_ort_1_1_checkpoint_state_a0afa164a5656c00f59c5f5bcab17dce2}{LoadCheckpoint}}(\textcolor{keyword}{const}\ std::basic\_string<ORTCHAR\_T>\&\ path\_to\_checkpoint);}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00098\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ort_1_1_checkpoint_state_aeb65455e24b892fb64e2f375a86ddd4a}{SaveCheckpoint}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_ort_1_1_checkpoint_state}{CheckpointState}}\&\ checkpoint\_state,}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::basic\_string<ORTCHAR\_T>\&\ path\_to\_checkpoint,}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ include\_optimizer\_state\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00112\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ort_1_1_checkpoint_state_a18e12471a1f5eca44b8f2c15a7a7f801}{AddProperty}}(\textcolor{keyword}{const}\ std::string\&\ property\_name,\ \textcolor{keyword}{const}\ Property\&\ property\_value);}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00123\ \ \ Property\ \mbox{\hyperlink{class_ort_1_1_checkpoint_state_aea4163c2d1cefd73af25eb925aeeadc1}{GetProperty}}(\textcolor{keyword}{const}\ std::string\&\ property\_name);}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00126\ \};}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00139\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_ort_1_1_training_session}{TrainingSession}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{struct_ort_1_1detail_1_1_base}{detail::Base}}<OrtTrainingSession>\ \{}
\DoxyCodeLine{00140\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00141\ \ \ \textcolor{keywordtype}{size\_t}\ training\_model\_output\_count\_,\ eval\_model\_output\_count\_;}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00161\ \ \ \mbox{\hyperlink{class_ort_1_1_training_session_afce2cfbc95c88626e5f0802e8b76a5a1}{TrainingSession}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_ort_1_1_env}{Env}}\&\ env,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_ort_1_1_session_options}{SessionOptions}}\&\ session\_options,\ \mbox{\hyperlink{class_ort_1_1_checkpoint_state}{CheckpointState}}\&\ checkpoint\_state,}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::basic\_string<ORTCHAR\_T>\&\ train\_model\_path,}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::optional<std::basic\_string<ORTCHAR\_T>>\&\ eval\_model\_path\ =\ std::nullopt,}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::optional<std::basic\_string<ORTCHAR\_T>>\&\ optimizer\_model\_path\ =\ std::nullopt);}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00187\ \ \ std::vector<Value>\ \mbox{\hyperlink{class_ort_1_1_training_session_a9785fb39a9c7194d0015bb2c9eb74ab6}{TrainStep}}(\textcolor{keyword}{const}\ std::vector<Value>\&\ input\_values);}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00196\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ort_1_1_training_session_a6d754a8817f5c71170fafb5feebfb8ee}{LazyResetGrad}}();}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00207\ \ \ std::vector<Value>\ \mbox{\hyperlink{class_ort_1_1_training_session_a1aca68bdee1e26cd5838ec7da9b2d0c8}{EvalStep}}(\textcolor{keyword}{const}\ std::vector<Value>\&\ input\_values);}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00224\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ort_1_1_training_session_afffbcd32c5c5cd53ee55bd4a463303b7}{SetLearningRate}}(\textcolor{keywordtype}{float}\ learning\_rate);}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00235\ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{class_ort_1_1_training_session_a681e7ea539c9a4cf517bed5ef53e7ab4}{GetLearningRate}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00249\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ort_1_1_training_session_a116e1770b62abe3d3ef3dc9afebcd6a9}{RegisterLinearLRScheduler}}(int64\_t\ warmup\_step\_count,\ int64\_t\ total\_step\_count,}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ initial\_lr);}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00261\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ort_1_1_training_session_aecb39113eb291195701aa15f8ad378a8}{SchedulerStep}}();}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00272\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ort_1_1_training_session_a065d5a04f04d45af7e2052708c52d21e}{OptimizerStep}}();}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00292\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ort_1_1_training_session_a67df45e244a1ddcca99f430a2c9262e3}{ExportModelForInferencing}}(\textcolor{keyword}{const}\ std::basic\_string<ORTCHAR\_T>\&\ inference\_model\_path,}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::string>\&\ graph\_output\_names);}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00309\ \ \ std::vector<std::string>\ \mbox{\hyperlink{class_ort_1_1_training_session_a333b95516b40c40bffcf868154c11a9b}{InputNames}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ training);}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00321\ \ \ std::vector<std::string>\ \mbox{\hyperlink{class_ort_1_1_training_session_af03322a503328d875c301367ab89c584}{OutputNames}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ training);}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00334\ \ \ \mbox{\hyperlink{struct_ort_1_1_value}{Value}}\ \mbox{\hyperlink{class_ort_1_1_training_session_a80f2f71bc5f0889957a5cd5f28f004a8}{ToBuffer}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ only\_trainable);}
\DoxyCodeLine{00335\ }
\DoxyCodeLine{00340\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ort_1_1_training_session_afed699e00a7e7c60b591774788f8bb23}{FromBuffer}}(\mbox{\hyperlink{struct_ort_1_1_value}{Value}}\&\ buffer);}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00343\ \};}
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00354\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{group___training_cpp_ga931a23f07cb2eec0f21a8e9e89658dc0}{SetSeed}}(\textcolor{keyword}{const}\ int64\_t\ seed);}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ \}\ \ \textcolor{comment}{//\ namespace\ Ort}}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ \textcolor{preprocessor}{\#include\ "{}onnxruntime\_training\_cxx\_inline.h"{}}}

\end{DoxyCode}
